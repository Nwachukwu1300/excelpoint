# Task ID: 9
# Title: Implement Chat Session Persistence
# Status: pending
# Dependencies: 4
# Priority: medium
# Description: Build robust chat session management with conversation continuity and proper cleanup
# Details:
Implement session lifecycle management: create session on first message, maintain active sessions, cleanup inactive sessions. Add session metadata tracking: last_activity, message_count, session_duration. Create background Celery task cleanup_inactive_sessions that runs daily to remove sessions older than 30 days. Implement conversation continuity by loading recent chat history (last 10 messages) when user returns. Add session management endpoints: GET /api/subjects/{subject_id}/chat/sessions/ for listing user sessions, DELETE /api/subjects/{subject_id}/chat/sessions/{session_id}/ for clearing conversations. Use database transactions for consistency when creating messages and updating sessions.

# Test Strategy:
Unit tests for session lifecycle management. Integration tests for conversation continuity. Test cleanup tasks with mock data. Test concurrent session access scenarios.
